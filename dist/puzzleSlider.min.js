!function(i,n,e){i.fn.puzzleSlider=function(e){var t={state:"auto",slicesX:6,slicesY:5,slicesTime:3e3,waitingTime:4e3};e=i.extend(t,e),this.addClass("puzzle-slider").css("overflow","hidden");var s,o,a,c,r,l,d,u,f,p=this,h=p.outerWidth(),v=p.outerHeight(),m=p.find(".item"),g=0,b=e.slicesX*e.slicesY,w=[],y=e.slicesTime/(e.slicesX*e.slicesY);return function(){function t(){for(var i=0;i<b;i++)w.push(i)}function k(n){s.each(function(e){var t=i(this);d=t.position();var s=t.find(".inner-slice");u=d.left,f=d.top,s.css({"background-image":"url("+n+")","background-size":h+"px "+v+"px","background-position":"-"+u+"px -"+f+"px"})}),m.hide()}function x(){s.find(".inner-slice.active").css({transition:"none","-webkit-transition":"none","-moz-transition":"none","-ms-transition":"none",opacity:"0.5"})}function z(){s.find(".inner-slice.active").css({transition:"opacity 0.5s linear","-webkit-transition":"opacity 0.5s linear","-moz-transition":"opacity 0.5s linear","-ms-transition":"opacity 0.5s linear",opacity:"1"})}function T(i,n){function o(n){setTimeout(function(){s.eq(n).find(".inner-slice").addClass("active"),x()},y*c),setTimeout(function(){s.eq(n).find(".inner-slice"),z(),s.eq(n).find(".inner-slice").css("background-image","url("+i+")").removeClass("active"),"hover"===e.state&&s.eq(n).find(".inner-slice").parent().addClass("done"),"auto"===e.state&&++a===b&&(t(),q())},y*c+10)}var a=0;if("auto"===e.state)for(var c=0;c<b;c++)o(l=w[Math.floor(Math.random()*w.length)]),w.splice(w.indexOf(l),1);else"hover"===e.state&&o(n)}function q(){"auto"===e.state?function(){setTimeout(function(){g==m.length-1?g=0:g++,T(m.eq(g).attr("src"))},e.waitingTime)}():"hover"===e.state&&function(){function n(){s.removeClass("done"),++g>=m.length&&(g=0)}g++,s.find(".inner-slice").mouseover(function(){if(0===i(this).parents(".slice.done").length){var e=i(this);T(m.eq(g).attr("src"),e.parent().index())}setTimeout(function(){p.find(".slice.done").length===b&&setTimeout(n,50)},10)})}()}function Y(){h=p.outerWidth(),v=p.outerHeight(),o.css({"background-size":h+"px "+v+"px"}),c=v/e.slicesY,s.height(c),s.each(function(n){var e=i(this),t=e.find(".inner-slice");d=e.position(),u=d.left,f=d.top,t.css({"background-position":"-"+u+"px -"+f+"px"})})}t(),function(){a=h/e.slicesX,c=v/e.slicesY;var i=e.slicesX*e.slicesY;p.append('<div class="active-slider"></div>');for(var n=1;n<=i;n++)p.find(".active-slider").css("position","relative").append('<span class="slice"><span class="inner-slice"></span></span>');s=p.find(".active-slider .slice"),o=s.find(".inner-slice"),s.width(a/h*100+"%").height(c)}(),function(){s.width(a/h*100+"%").height(c).css({display:"inline-block",float:"left","background-repeat":"no-repeat"}),o.css({width:"100%",height:"100%",display:"block",transition:"opacity 0.5s linear","-webkit-transition":"opacity 0.5s linear","-moz-transition":"opacity 0.5s linear","-ms-transition":"opacity 0.5s linear"})}(),function(){k(r=m.eq(g).attr("src"))}(),q(),i(n).bind("resize",Y)}(),this}}(window.jQuery,window,document);