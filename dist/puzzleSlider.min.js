!function(i,e,s){i.fn.puzzleSlider=function(s){this.css("overflow","hidden"),s=i.extend({state:"auto",slicesX:6,slicesY:5,slicesTime:3e3,waitingTime:4e3},s);var t={slider:this,sliderWidth:this.outerWidth(),sliderHeight:this.outerHeight(),slide:this.find(".item"),slices:null,slicesInner:null,current:0,slicesLength:s.slicesX*s.slicesY,slicesArray:[],sliceWidth:null,sliceHeight:null,imageSrc:null,selectedSlice:null,slicePosition:null,leftPosition:null,topPosition:null,slicesTime:s.slicesTime/(s.slicesX*s.slicesY)};return function(){function n(){for(var i=0;i<t.slicesLength;i++)t.slicesArray.push(i)}function l(e){t.slices.each(function(s){var n=i(this);t.sliceWidth,t.sliceHeight,t.slicePosition=n.position();var l=n.find(".inner-slice");t.leftPosition=t.slicePosition.left,t.topPosition=t.slicePosition.top,l.css({"background-image":"url("+e+")","background-size":t.sliderWidth+"px "+t.sliderHeight+"px","background-position":"-"+t.leftPosition+"px -"+t.topPosition+"px"})}),t.slide.hide()}function c(){t.slices.find(".inner-slice.active").css({transition:"none","-webkit-transition":"none","-moz-transition":"none","-ms-transition":"none",opacity:"0.5"})}function o(){t.slices.find(".inner-slice.active").css({transition:"opacity 0.5s linear","-webkit-transition":"opacity 0.5s linear","-moz-transition":"opacity 0.5s linear","-ms-transition":"opacity 0.5s linear",opacity:"1"})}function r(i,e){function l(e){setTimeout(function(){t.slices.eq(e).find(".inner-slice").addClass("active"),c()},t.slicesTime*d),setTimeout(function(){t.slices.eq(e).find(".inner-slice"),o(),t.slices.eq(e).find(".inner-slice").css("background-image","url("+i+")").removeClass("active"),"hover"===s.state&&t.slices.eq(e).find(".inner-slice").parent().addClass("done"),"auto"===s.state&&++r===t.slicesLength&&(n(),a())},t.slicesTime*d+10)}var r=0;if("auto"===s.state)for(var d=0;d<t.slicesLength;d++)t.selectedSlice=t.slicesArray[Math.floor(Math.random()*t.slicesArray.length)],l(t.selectedSlice),t.slicesArray.splice(t.slicesArray.indexOf(t.selectedSlice),1);else"hover"===s.state&&l(e)}function a(){"auto"===s.state?function(){setTimeout(function(){t.current==t.slide.length-1?t.current=0:t.current++,r(t.slide.eq(t.current).attr("src"))},s.waitingTime)}():"hover"===s.state&&function(){function e(){t.slices.removeClass("done"),++t.current>=t.slide.length&&(t.current=0)}t.current++,t.slices.find(".inner-slice").mouseover(function(){if(0===i(this).parents(".slice.done").length){var s=i(this);r(t.slide.eq(t.current).attr("src"),s.parent().index())}setTimeout(function(){t.slider.find(".slice.done").length===t.slicesLength&&setTimeout(e,50)},10)})}()}function d(){t.sliderWidth=t.slider.outerWidth(),t.sliderHeight=t.slider.outerHeight(),t.slicesInner.css({"background-size":t.sliderWidth+"px "+t.sliderHeight+"px"}),t.sliceHeight=t.sliderHeight/s.slicesY,t.slices.height(t.sliceHeight),t.slices.each(function(e){var s=i(this),n=s.find(".inner-slice");t.slicePosition=s.position(),t.leftPosition=t.slicePosition.left,t.topPosition=t.slicePosition.top,n.css({"background-position":"-"+t.leftPosition+"px -"+t.topPosition+"px"})})}n(),function(){t.sliceWidth=t.sliderWidth/s.slicesX,t.sliceHeight=t.sliderHeight/s.slicesY;var i=s.slicesX*s.slicesY;t.slider.append('<div class="active-slider"></div>');for(var e=1;e<=i;e++)t.slider.find(".active-slider").css("position","relative").append('<span class="slice"><span class="inner-slice"></span></span>');t.slices=t.slider.find(".active-slider .slice"),t.slicesInner=t.slices.find(".inner-slice"),t.slices.width(t.sliceWidth/t.sliderWidth*100+"%").height(t.sliceHeight)}(),function(){t.slices.width(t.sliceWidth/t.sliderWidth*100+"%").height(t.sliceHeight).css({display:"inline-block",float:"left","background-repeat":"no-repeat"}),t.slicesInner.css({width:"100%",height:"100%",display:"block",transition:"opacity 0.5s linear","-webkit-transition":"opacity 0.5s linear","-moz-transition":"opacity 0.5s linear","-ms-transition":"opacity 0.5s linear"})}(),function(){t.imageSrc=t.slide.eq(t.current).attr("src"),l(t.imageSrc)}(),a(),i(e).bind("resize",d)}(),this}}(window.jQuery,window,document);